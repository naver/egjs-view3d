<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content="#2D3142">
  <link rel="shortcut icon" type="image/png" href="../favicon.png"/>
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/ar.css">
  <link rel="stylesheet" href="../css/buttons.css">
  <link rel="stylesheet" href="../lib/prism.css">
  <script type="text/javascript" src="../release/latest/dist/view3d.pkgd.js"></script>
  <script type="text/javascript" src="../lib/prism.js" data-manual></script>
</head>
<body>
  <div id="view3d-wrapper">
    <div class="demo-wrapper">
      <a id="back-anchor" href="../index.html">
        <svg id="back-arrow" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <line x1="0" y1="50" x2="50" y2="90" fill="transparent" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"></line>
          <line x1="0" y1="50" x2="50" y2="10" fill="transparent" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"></line>
          <line x1="10" y1="50" x2="100" y2="50" fill="transparent" stroke-width="10"></line>
        </svg>
        <span>Back to Main</span>
      </a>
      <div class="demo-desc-placeholder">
        <div class="demo-desc-wrapper">
          <h1 class="demo-title">AR-Portal Effect</h1>
          <h2 class="demo-subtitle"></h2>
          <p class="demo-desc">
            This is an AR showcase for special effect which can be only enabled in WebXR-based session.<br/>
            This effect is made by changing model's material to write stencil values.
          </p>
          <pre class="code"><code id="page-src" class="language-js">model.meshes.forEach(mesh => {
  const prevMat = mesh.material;

  mesh.material = new THREE.MeshBasicMaterial().copy(prevMat);
  mesh.material.map = prevMat.emissiveMap;
  mesh.material.stencilWrite = true;
  mesh.material.stencilRef = 1;
  mesh.material.stencilFunc = THREE.EqualStencilFunc;
  mesh.material.needsUpdate = true;
});</code></pre>
          <div class="demo-footer">
            <div><a href="https://sketchfab.com/3d-models/the-smoking-room-2247ed77976a40b6ae81271cd6b149c8">The Smoking Room</a> by <a href="https://sketchfab.com/TheHallwylMuseum">The Hallwyl Museum(Hallwylska museet)</a>, Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div>
            <div><a href="https://sketchfab.com/3d-models/decorative-portal-986ba426507e42398f2f222939ba5e1c">Decorative Portal</a> by <a href="https://sketchfab.com/dikart">Dikart</a>, Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div>
          </div>
        </div>
      </div>
    </div>
    <div class="view3d-canvas-wrapper">
      <canvas id="view3d-canvas"></canvas>
      <div id="ar-button">
        <svg id="ar-icon" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 30 L 50 15 L 80 30 L 50 45 L 20 30 V 70 L 50 85 L 80 70 V 30 M 50 45 V 85"
            fill="transparent" stroke="black" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <span>View in AR</span>
      </div>
    </div>
  </div>
  <div id="overlay">
    <div id="xr-close">
      <svg id="close-icon" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <line x1="2" y1="22" x2="22" y2="2" stroke="white" stroke-width="2"/>
        <line x1="2" y1="2" x2="22" y2="22" stroke="white" stroke-width="2"/>
      </svg>
    </div>
    <div id="loading">
      <div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
      <div>바닥면을 찾는 중입니다...</div>
      <div>방 안을 밝게 해주시고 화면을 이리저리 움직여주세요</div>
    </div>
  </div>
  <script type="text/javascript" src="../js/ar-portal.js"></script>
</body>
